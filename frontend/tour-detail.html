<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chi tiết Tour - Du Lịch Hoàng Minh</title>

    <!-- favicon -->
    <link rel="shortcut icon" href="./favicon.svg" type="image/svg+xml">    <!-- custom css link -->
    <link rel="stylesheet" href="./assets/css/style.css">
    <link rel="stylesheet" href="./assets/css/tour-detail.css">
    <link rel="stylesheet" href="./assets/css/toast.css">

    <!-- google font link -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;600;700;800&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body id="top">

    <!-- Header -->
    <header class="header" data-header>
        <div class="overlay" data-overlay></div>

        <div class="header-top">
            <div class="container">
                <a href="tel:+84123456789" class="helpline-box">
                    <div class="icon-box">
                        <ion-icon name="call-outline"></ion-icon>
                    </div>
                    <div class="wrapper">
                        <p class="helpline-title" data-translate="helpline_title">Để biết thêm thông tin:</p>
                        <p class="helpline-number">+84 (123) 456 789</p>
                    </div>
                </a>

                <a href="index.html" class="logo">
                    <img src="./assets/images/logo-blue.svg" alt="Du Lịch Hoàng Minh">
                </a>

                <div class="header-btn-group">
                    <button class="search-btn" aria-label="Tìm kiếm">
                        <ion-icon name="search"></ion-icon>
                    </button>

                    <button class="nav-open-btn" aria-label="Mở menu" data-nav-open-btn>
                        <ion-icon name="menu-outline"></ion-icon>
                    </button>
                </div>
            </div>
        </div>

        <div class="header-bottom">
            <div class="container">
                <ul class="social-list">
                    <li><a href="#" class="social-link"><ion-icon name="logo-facebook"></ion-icon></a></li>
                    <li><a href="#" class="social-link"><ion-icon name="logo-twitter"></ion-icon></a></li>
                    <li><a href="#" class="social-link"><ion-icon name="logo-youtube"></ion-icon></a></li>
                </ul>

                <nav class="navbar" data-navbar>
                    <div class="navbar-top">
                        <a href="index.html" class="logo">
                            <img src="./assets/images/logo-blue.svg" alt="Du Lịch Hoàng Minh">
                        </a>
                        <button class="nav-close-btn" aria-label="Đóng menu" data-nav-close-btn>
                            <ion-icon name="close-outline"></ion-icon>
                        </button>
                    </div>

                    <ul class="navbar-list">
                        <li><a href="index.html" class="navbar-link" data-nav-link data-translate="home">Trang chủ</a></li>
                        <li><a href="about.html" class="navbar-link" data-nav-link data-translate="about_us">Về chúng tôi</a></li>
                        <li><a href="tours.html" class="navbar-link" data-nav-link data-translate="packages">Gói tour</a></li>
                        <li><a href="gallery.html" class="navbar-link" data-nav-link data-translate="gallery">Thư viện ảnh</a></li>
                        <li><a href="articles.html" class="navbar-link" data-nav-link data-translate="articles">Bài viết</a></li>
                        <li><a href="contact.html" class="navbar-link" data-nav-link data-translate="contact_us">Liên hệ</a></li>
                    </ul>
                </nav>

                <!-- Auth Section -->
                <div class="auth-section">
                    <!-- Authentication buttons (shown when not logged in) -->
                    <div class="auth-buttons" id="authButtons">
                        <a href="login.html" class="btn btn-outline" data-translate="login">Đăng nhập</a>
                        <a href="register.html" class="btn btn-primary" data-translate="register">Đăng ký</a>
                    </div>

                    <!-- User menu (shown when logged in) -->
                    <div class="user-menu" id="userMenu" style="display: none;">
                        <div class="user-dropdown">
                            <button class="user-trigger" id="userTrigger">
                                <div class="user-avatar">
                                    <ion-icon name="person-outline"></ion-icon>
                                </div>
                                <span class="user-name" id="userName">User</span>
                                <ion-icon name="chevron-down-outline" class="dropdown-icon"></ion-icon>
                            </button>
                            
                            <div class="user-dropdown-menu" id="userDropdownMenu">
                                <a href="profile.html" class="dropdown-item">
                                    <ion-icon name="person-outline"></ion-icon>
                                    <span data-translate="profile">Hồ sơ</span>
                                </a>
                                <a href="bookings.html" class="dropdown-item">
                                    <ion-icon name="calendar-outline"></ion-icon>
                                    <span data-translate="my_bookings">Đặt chỗ của tôi</span>
                                </a>
                                <a href="favorites.html" class="dropdown-item">
                                    <ion-icon name="heart-outline"></ion-icon>
                                    <span data-translate="favorites">Yêu thích</span>
                                </a>
                                <div class="dropdown-divider"></div>
                                <button class="dropdown-item logout-btn" id="logoutBtn">
                                    <ion-icon name="log-out-outline"></ion-icon>
                                    <span data-translate="logout">Đăng xuất</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main>        <!-- Breadcrumb -->
        <section class="breadcrumb-section">
            <div class="container">
                <nav class="breadcrumb">
                    <a href="index.html" data-translate="home">Trang chủ</a>
                    <ion-icon name="chevron-forward-outline"></ion-icon>
                    <a href="tours.html" data-translate="packages">Gói tour</a>
                    <ion-icon name="chevron-forward-outline"></ion-icon>
                    <span id="tourNameBreadcrumb">Chi tiết tour</span>
                </nav>
            </div>
        </section>

        <!-- Tour Detail -->
        <section class="tour-detail-section">
            <div class="container">
                <div class="tour-detail-wrapper" id="tourDetailWrapper">
                    <!-- Loading state -->
                    <div class="loading-spinner">
                        <div class="spinner"></div>
                        <p data-translate="loading">Đang tải...</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Related Tours -->
        <section class="related-tours-section">
            <div class="container">
                <h2 class="section-title" data-translate="related_tours">Tour liên quan</h2>
                <div class="related-tours-grid" id="relatedToursGrid">
                    <!-- Related tours will be loaded here -->
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-top">
            <div class="container">
                <div class="footer-brand">
                    <a href="index.html" class="logo">
                        <img src="./assets/images/logo.svg" alt="Du Lịch Hoàng Minh">
                    </a>
                    <p class="footer-text">
                        Chúng tôi là công ty du lịch hàng đầu với kinh nghiệm nhiều năm trong việc tổ chức các chuyến du lịch 
                        trong nước và quốc tế. Cam kết mang đến dịch vụ tốt nhất cho khách hàng.
                    </p>
                </div>

                <div class="footer-contact">
                    <h4 class="contact-title" data-translate="contact_us">Liên hệ với chúng tôi</h4>
                    <p class="contact-text">Hãy liên hệ với chúng tôi để được tư vấn và hỗ trợ!</p>
                    <ul>
                        <li class="contact-item">
                            <ion-icon name="call-outline"></ion-icon>
                            <a href="tel:+84123456789" class="contact-link">+84 (123) 456 789</a>
                        </li>
                        <li class="contact-item">
                            <ion-icon name="mail-outline"></ion-icon>
                            <a href="mailto:info@hoangminhtravel.com" class="contact-link">info@hoangminhtravel.com</a>
                        </li>
                        <li class="contact-item">
                            <ion-icon name="location-outline"></ion-icon>
                            <address>123 Đường ABC, Quận 1, TP. Hồ Chí Minh</address>
                        </li>
                    </ul>
                </div>

                <div class="footer-form">
                    <p class="form-text" data-translate="newsletter_text">
                        Đăng ký nhận bản tin để cập nhật thông tin tour mới nhất!
                    </p>
                    <form action="" class="form-wrapper">
                        <input type="email" name="email" class="input-field" 
                               data-translate-placeholder="email_address" placeholder="Nhập email của bạn" required>
                        <button type="submit" class="btn btn-secondary" data-translate="subscribe">Đăng ký</button>
                    </form>
                </div>
            </div>
        </div>

        <div class="footer-bottom">
            <div class="container">
                <p class="copyright">
                    &copy; 2024 <a href="">Du Lịch Hoàng Minh</a>. <span data-translate="all_rights_reserved">Tất cả quyền được bảo lưu</span>
                </p>
                <ul class="footer-bottom-list">
                    <li><a href="#" class="footer-bottom-link">Chính sách bảo mật</a></li>
                    <li><a href="#" class="footer-bottom-link">Điều khoản & Điều kiện</a></li>
                    <li><a href="#" class="footer-bottom-link">FAQ</a></li>
                </ul>
            </div>
        </div>
    </footer>

    <!-- Go to top -->
    <a href="#top" class="go-top" data-go-top>
        <ion-icon name="chevron-up-outline"></ion-icon>
    </a>    <!-- Toast notification -->
    <div id="toast" class="toast"></div>    <!-- Scripts -->
    <script src="./assets/js/api.js"></script>
    <script src="./assets/js/language.js"></script>
    <script src="./assets/js/auth.js"></script>
    <script src="./assets/js/header.js"></script>
    <script src="./assets/js/tour-detail.js"></script>
    <script src="./assets/js/script.js"></script>

    <!-- Additional script to ensure proper initialization -->
    <script>
        // Ensure TourDetailManager is available before trying to use it
        function initializeTourDetailManager() {
            console.log('Checking TourDetailManager availability...');
            
            if (typeof TourDetailManager !== 'undefined') {
                console.log('TourDetailManager class found, creating instance...');
                
                try {
                    if (!window.tourDetailManager) {
                        window.tourDetailManager = new TourDetailManager();
                        console.log('TourDetailManager instance created successfully');
                    }
                    
                    // Bind global methods for onclick handlers
                    window.editReview = (reviewId) => window.tourDetailManager.editReview(reviewId);
                    window.deleteReview = (reviewId) => window.tourDetailManager.deleteReview(reviewId);
                    window.showReviewForm = () => window.tourDetailManager.showReviewForm();
                    window.hideReviewForm = () => window.tourDetailManager.hideReviewForm();
                    window.changeMainImage = (src, thumbElement) => window.tourDetailManager.changeMainImage(src, thumbElement);
                    window.showBookingModal = () => window.tourDetailManager.showBookingModal();
                    window.toggleWishlist = () => window.tourDetailManager.toggleWishlist();
                    
                    console.log('Global methods bound successfully');
                    return true;
                } catch (error) {
                    console.error('Failed to create TourDetailManager instance:', error);
                    return false;
                }
            } else {
                console.error('TourDetailManager class not found');
                return false;
            }
        }

        // Try initialization on DOMContentLoaded
        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOM Content Loaded - trying initialization...');
            
            // Wait a bit for all scripts to load
            setTimeout(() => {
                if (!initializeTourDetailManager()) {
                    console.log('First attempt failed, retrying...');
                    
                    // Retry after a longer delay
                    setTimeout(() => {
                        initializeTourDetailManager();
                    }, 1000);
                }
            }, 100);
        });

        // Also try on window load as backup
        window.addEventListener('load', () => {
            console.log('Window loaded - backup initialization...');
            
            if (!window.tourDetailManager) {
                initializeTourDetailManager();
            }
        });
    </script>

    <!-- ionicon link -->
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>

</body>

</html>
